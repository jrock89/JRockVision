!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(t,e){var i=0,n=Array.prototype.slice,a=t.cleanData;t.cleanData=function(e){for(var i,n=0;null!=(i=e[n]);n++)try{t(i).triggerHandler("remove")}catch(o){}a(e)},t.widget=function(e,i,n){var a,o,s,r,l={},h=e.split(".")[0];e=e.split(".")[1],a=h+"-"+e,n||(n=i,i=t.Widget),t.expr[":"][a.toLowerCase()]=function(e){return!!t.data(e,a)},t[h]=t[h]||{},o=t[h][e],s=t[h][e]=function(t,e){return this._createWidget?void(arguments.length&&this._createWidget(t,e)):new s(t,e)},t.extend(s,o,{version:n.version,_proto:t.extend({},n),_childConstructors:[]}),r=new i,r.options=t.widget.extend({},r.options),t.each(n,function(e,n){return t.isFunction(n)?void(l[e]=function(){var t=function(){return i.prototype[e].apply(this,arguments)},a=function(t){return i.prototype[e].apply(this,t)};return function(){var e,i=this._super,o=this._superApply;return this._super=t,this._superApply=a,e=n.apply(this,arguments),this._super=i,this._superApply=o,e}}()):void(l[e]=n)}),s.prototype=t.widget.extend(r,{widgetEventPrefix:o?r.widgetEventPrefix:e},l,{constructor:s,namespace:h,widgetName:e,widgetFullName:a}),o?(t.each(o._childConstructors,function(e,i){var n=i.prototype;t.widget(n.namespace+"."+n.widgetName,s,i._proto)}),delete o._childConstructors):i._childConstructors.push(s),t.widget.bridge(e,s)},t.widget.extend=function(i){for(var a,o,s=n.call(arguments,1),r=0,l=s.length;l>r;r++)for(a in s[r])o=s[r][a],s[r].hasOwnProperty(a)&&o!==e&&(i[a]=t.isPlainObject(o)?t.isPlainObject(i[a])?t.widget.extend({},i[a],o):t.widget.extend({},o):o);return i},t.widget.bridge=function(i,a){var o=a.prototype.widgetFullName||i;t.fn[i]=function(s){var r="string"==typeof s,l=n.call(arguments,1),h=this;return s=!r&&l.length?t.widget.extend.apply(null,[s].concat(l)):s,this.each(r?function(){var n,a=t.data(this,o);return a?t.isFunction(a[s])&&"_"!==s.charAt(0)?(n=a[s].apply(a,l),n!==a&&n!==e?(h=n&&n.jquery?h.pushStack(n.get()):n,!1):void 0):t.error("no such method '"+s+"' for "+i+" widget instance"):t.error("cannot call methods on "+i+" prior to initialization; attempted to call method '"+s+"'")}:function(){var e=t.data(this,o);e?e.option(s||{})._init():t.data(this,o,new a(s,this))}),h}},t.Widget=function(){},t.Widget._childConstructors=[],t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(e,n){n=t(n||this.defaultElement||this)[0],this.element=t(n),this.uuid=i++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=t.widget.extend({},this.options,this._getCreateOptions(),e),this.bindings=t(),this.hoverable=t(),this.focusable=t(),n!==this&&(t.data(n,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===n&&this.destroy()}}),this.document=t(n.style?n.ownerDocument:n.document||n),this.window=t(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:t.noop,_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(t.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:t.noop,widget:function(){return this.element},option:function(i,n){var a,o,s,r=i;if(0===arguments.length)return t.widget.extend({},this.options);if("string"==typeof i)if(r={},a=i.split("."),i=a.shift(),a.length){for(o=r[i]=t.widget.extend({},this.options[i]),s=0;s<a.length-1;s++)o[a[s]]=o[a[s]]||{},o=o[a[s]];if(i=a.pop(),n===e)return o[i]===e?null:o[i];o[i]=n}else{if(n===e)return this.options[i]===e?null:this.options[i];r[i]=n}return this._setOptions(r),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return this.options[t]=e,"disabled"===t&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!e).attr("aria-disabled",e),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(e,i,n){var a,o=this;"boolean"!=typeof e&&(n=i,i=e,e=!1),n?(i=a=t(i),this.bindings=this.bindings.add(i)):(n=i,i=this.element,a=this.widget()),t.each(n,function(n,s){function r(){return e||o.options.disabled!==!0&&!t(this).hasClass("ui-state-disabled")?("string"==typeof s?o[s]:s).apply(o,arguments):void 0}"string"!=typeof s&&(r.guid=s.guid=s.guid||r.guid||t.guid++);var l=n.match(/^(\w+)\s*(.*)$/),h=l[1]+o.eventNamespace,u=l[2];u?a.delegate(u,h,r):i.bind(h,r)})},_off:function(t,e){e=(e||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.unbind(e).undelegate(e)},_delay:function(t,e){function i(){return("string"==typeof t?n[t]:t).apply(n,arguments)}var n=this;return setTimeout(i,e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){t(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){t(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){t(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){t(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,i,n){var a,o,s=this.options[e];if(n=n||{},i=t.Event(i),i.type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),i.target=this.element[0],o=i.originalEvent)for(a in o)a in i||(i[a]=o[a]);return this.element.trigger(i,n),!(t.isFunction(s)&&s.apply(this.element[0],[i].concat(n))===!1||i.isDefaultPrevented())}},t.each({show:"fadeIn",hide:"fadeOut"},function(e,i){t.Widget.prototype["_"+e]=function(n,a,o){"string"==typeof a&&(a={effect:a});var s,r=a?a===!0||"number"==typeof a?i:a.effect||i:e;a=a||{},"number"==typeof a&&(a={duration:a}),s=!t.isEmptyObject(a),a.complete=o,a.delay&&n.delay(a.delay),s&&t.effects&&t.effects.effect[r]?n[e](a):r!==e&&n[r]?n[r](a.duration,a.easing,o):n.queue(function(i){t(this)[e](),o&&o.call(n[0]),i()})}})}),function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery"],t):t(window.jQuery)}(function(t){"use strict";var e=0;t.ajaxTransport("iframe",function(i){if(i.async){var n,a,o;return{send:function(s,r){n=t('<form style="display:none;"></form>'),n.attr("accept-charset",i.formAcceptCharset),o=/\?/.test(i.url)?"&":"?","DELETE"===i.type?(i.url=i.url+o+"_method=DELETE",i.type="POST"):"PUT"===i.type?(i.url=i.url+o+"_method=PUT",i.type="POST"):"PATCH"===i.type&&(i.url=i.url+o+"_method=PATCH",i.type="POST"),a=t('<iframe src="javascript:false;" name="iframe-transport-'+(e+=1)+'"></iframe>').bind("load",function(){var e,o=t.isArray(i.paramName)?i.paramName:[i.paramName];a.unbind("load").bind("load",function(){var e;try{if(e=a.contents(),!e.length||!e[0].firstChild)throw new Error}catch(i){e=void 0}r(200,"success",{iframe:e}),t('<iframe src="javascript:false;"></iframe>').appendTo(n),n.remove()}),n.prop("target",a.prop("name")).prop("action",i.url).prop("method",i.type),i.formData&&t.each(i.formData,function(e,i){t('<input type="hidden"/>').prop("name",i.name).val(i.value).appendTo(n)}),i.fileInput&&i.fileInput.length&&"POST"===i.type&&(e=i.fileInput.clone(),i.fileInput.after(function(t){return e[t]}),i.paramName&&i.fileInput.each(function(e){t(this).prop("name",o[e]||i.paramName)}),n.append(i.fileInput).prop("enctype","multipart/form-data").prop("encoding","multipart/form-data")),n.submit(),e&&e.length&&i.fileInput.each(function(i,n){var a=t(e[i]);t(n).prop("name",a.prop("name")),a.replaceWith(n)})}),n.append(a).appendTo(document.body)},abort:function(){a&&a.unbind("load").prop("src","javascript".concat(":false;")),n&&n.remove()}}}}),t.ajaxSetup({converters:{"iframe text":function(e){return e&&t(e[0].body).text()},"iframe json":function(e){return e&&t.parseJSON(t(e[0].body).text())},"iframe html":function(e){return e&&t(e[0].body).html()},"iframe script":function(e){return e&&t.globalEval(t(e[0].body).text())}}})}),function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery","jquery.ui.widget"],t):t(window.jQuery)}(function(t){"use strict";t.support.xhrFileUpload=!(!window.XMLHttpRequestUpload||!window.FileReader),t.support.xhrFormDataFileUpload=!!window.FormData,t.propHooks.elements={get:function(e){return t.nodeName(e,"form")?t.grep(e.elements,function(e){return!t.nodeName(e,"input")||"file"!==e.type}):null}},t.widget("blueimp.fileupload",{options:{dropZone:t(document),pasteZone:t(document),fileInput:void 0,replaceFileInput:!0,paramName:void 0,singleFileUploads:!0,limitMultiFileUploads:void 0,sequentialUploads:!1,limitConcurrentUploads:void 0,forceIframeTransport:!1,redirect:void 0,redirectParamName:void 0,postMessage:void 0,multipart:!0,maxChunkSize:void 0,uploadedBytes:void 0,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,formData:function(t){return t.serializeArray()},add:function(t,e){e.submit()},processData:!1,contentType:!1,cache:!1},_refreshOptionsList:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_BitrateTimer:function(){this.timestamp=+new Date,this.loaded=0,this.bitrate=0,this.getBitrate=function(t,e,i){var n=t-this.timestamp;return(!this.bitrate||!i||n>i)&&(this.bitrate=(e-this.loaded)*(1e3/n)*8,this.loaded=e,this.timestamp=t),this.bitrate}},_isXHRUpload:function(e){return!e.forceIframeTransport&&(!e.multipart&&t.support.xhrFileUpload||t.support.xhrFormDataFileUpload)},_getFormData:function(e){var i;return"function"==typeof e.formData?e.formData(e.form):t.isArray(e.formData)?e.formData:e.formData?(i=[],t.each(e.formData,function(t,e){i.push({name:t,value:e})}),i):[]},_getTotal:function(e){var i=0;return t.each(e,function(t,e){i+=e.size||1}),i},_onProgress:function(t,e){if(t.lengthComputable){var i,n,a=+new Date;if(e._time&&e.progressInterval&&a-e._time<e.progressInterval&&t.loaded!==t.total)return;e._time=a,i=e.total||this._getTotal(e.files),n=parseInt(t.loaded/t.total*(e.chunkSize||i),10)+(e.uploadedBytes||0),this._loaded+=n-(e.loaded||e.uploadedBytes||0),e.lengthComputable=!0,e.loaded=n,e.total=i,e.bitrate=e._bitrateTimer.getBitrate(a,n,e.bitrateInterval),this._trigger("progress",t,e),this._trigger("progressall",t,{lengthComputable:!0,loaded:this._loaded,total:this._total,bitrate:this._bitrateTimer.getBitrate(a,this._loaded,e.bitrateInterval)})}},_initProgressListener:function(e){var i=this,n=e.xhr?e.xhr():t.ajaxSettings.xhr();n.upload&&(t(n.upload).bind("progress",function(t){var n=t.originalEvent;t.lengthComputable=n.lengthComputable,t.loaded=n.loaded,t.total=n.total,i._onProgress(t,e)}),e.xhr=function(){return n})},_initXHRData:function(e){var i,n=e.files[0],a=e.multipart||!t.support.xhrFileUpload,o=e.paramName[0];e.headers=e.headers||{},e.contentRange&&(e.headers["Content-Range"]=e.contentRange),a?t.support.xhrFormDataFileUpload&&(e.postMessage?(i=this._getFormData(e),e.blob?i.push({name:o,value:e.blob}):t.each(e.files,function(t,n){i.push({name:e.paramName[t]||o,value:n})})):(e.formData instanceof FormData?i=e.formData:(i=new FormData,t.each(this._getFormData(e),function(t,e){i.append(e.name,e.value)})),e.blob?(e.headers["Content-Disposition"]='attachment; filename="'+encodeURI(n.name)+'"',i.append(o,e.blob,n.name)):t.each(e.files,function(t,n){(window.Blob&&n instanceof Blob||window.File&&n instanceof File)&&i.append(e.paramName[t]||o,n,n.name)})),e.data=i):(e.headers["Content-Disposition"]='attachment; filename="'+encodeURI(n.name)+'"',e.contentType=n.type,e.data=e.blob||n),e.blob=null},_initIframeSettings:function(e){e.dataType="iframe "+(e.dataType||""),e.formData=this._getFormData(e),e.redirect&&t("<a></a>").prop("href",e.url).prop("host")!==location.host&&e.formData.push({name:e.redirectParamName||"redirect",value:e.redirect})},_initDataSettings:function(t){this._isXHRUpload(t)?(this._chunkedUpload(t,!0)||(t.data||this._initXHRData(t),this._initProgressListener(t)),t.postMessage&&(t.dataType="postmessage "+(t.dataType||""))):this._initIframeSettings(t,"iframe")},_getParamName:function(e){var i=t(e.fileInput),n=e.paramName;return n?t.isArray(n)||(n=[n]):(n=[],i.each(function(){for(var e=t(this),i=e.prop("name")||"files[]",a=(e.prop("files")||[1]).length;a;)n.push(i),a-=1}),n.length||(n=[i.prop("name")||"files[]"])),n},_initFormSettings:function(e){e.form&&e.form.length||(e.form=t(e.fileInput.prop("form")),e.form.length||(e.form=t(this.options.fileInput.prop("form")))),e.paramName=this._getParamName(e),e.url||(e.url=e.form.prop("action")||location.href),e.type=(e.type||e.form.prop("method")||"").toUpperCase(),"POST"!==e.type&&"PUT"!==e.type&&"PATCH"!==e.type&&(e.type="POST"),e.formAcceptCharset||(e.formAcceptCharset=e.form.attr("accept-charset"))},_getAJAXSettings:function(e){var i=t.extend({},this.options,e);return this._initFormSettings(i),this._initDataSettings(i),i},_enhancePromise:function(t){return t.success=t.done,t.error=t.fail,t.complete=t.always,t},_getXHRPromise:function(e,i,n){var a=t.Deferred(),o=a.promise();return i=i||this.options.context||o,e===!0?a.resolveWith(i,n):e===!1&&a.rejectWith(i,n),o.abort=a.promise,this._enhancePromise(o)},_getUploadedBytes:function(t){var e=t.getResponseHeader("Range"),i=e&&e.split("-"),n=i&&i.length>1&&parseInt(i[1],10);return n&&n+1},_chunkedUpload:function(e,i){var n,a,o=this,s=e.files[0],r=s.size,l=e.uploadedBytes=e.uploadedBytes||0,h=e.maxChunkSize||r,u=s.slice||s.webkitSlice||s.mozSlice,c=t.Deferred(),d=c.promise();return this._isXHRUpload(e)&&u&&(l||r>h)&&!e.data?i?!0:l>=r?(s.error="Uploaded bytes exceed file size",this._getXHRPromise(!1,e.context,[null,"error",s.error])):(a=function(){var i=t.extend({},e);i.blob=u.call(s,l,l+h,s.type),i.chunkSize=i.blob.size,i.contentRange="bytes "+l+"-"+(l+i.chunkSize-1)+"/"+r,o._initXHRData(i),o._initProgressListener(i),n=(o._trigger("chunksend",null,i)!==!1&&t.ajax(i)||o._getXHRPromise(!1,i.context)).done(function(n,s,h){l=o._getUploadedBytes(h)||l+i.chunkSize,(!i.loaded||i.loaded<i.total)&&o._onProgress(t.Event("progress",{lengthComputable:!0,loaded:l-i.uploadedBytes,total:l-i.uploadedBytes}),i),e.uploadedBytes=i.uploadedBytes=l,i.result=n,i.textStatus=s,i.jqXHR=h,o._trigger("chunkdone",null,i),o._trigger("chunkalways",null,i),r>l?a():c.resolveWith(i.context,[n,s,h])}).fail(function(t,e,n){i.jqXHR=t,i.textStatus=e,i.errorThrown=n,o._trigger("chunkfail",null,i),o._trigger("chunkalways",null,i),c.rejectWith(i.context,[t,e,n])})},this._enhancePromise(d),d.abort=function(){return n.abort()},a(),d):!1},_beforeSend:function(t,e){0===this._active&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer),this._active+=1,this._loaded+=e.uploadedBytes||0,this._total+=this._getTotal(e.files)},_onDone:function(e,i,n,a){if(!this._isXHRUpload(a)||!a.loaded||a.loaded<a.total){var o=this._getTotal(a.files)||1;this._onProgress(t.Event("progress",{lengthComputable:!0,loaded:o,total:o}),a)}a.result=e,a.textStatus=i,a.jqXHR=n,this._trigger("done",null,a)},_onFail:function(t,e,i,n){n.jqXHR=t,n.textStatus=e,n.errorThrown=i,this._trigger("fail",null,n),n.recalculateProgress&&(this._loaded-=n.loaded||n.uploadedBytes||0,this._total-=n.total||this._getTotal(n.files))},_onAlways:function(t,e,i,n){this._active-=1,this._trigger("always",null,n),0===this._active&&(this._trigger("stop"),this._loaded=this._total=0,this._bitrateTimer=null)},_onSend:function(e,i){var n,a,o,s,r=this,l=r._getAJAXSettings(i),h=function(){return r._sending+=1,l._bitrateTimer=new r._BitrateTimer,n=n||((a||r._trigger("send",e,l)===!1)&&r._getXHRPromise(!1,l.context,a)||r._chunkedUpload(l)||t.ajax(l)).done(function(t,e,i){r._onDone(t,e,i,l)}).fail(function(t,e,i){r._onFail(t,e,i,l)}).always(function(t,e,i){if(r._sending-=1,r._onAlways(t,e,i,l),l.limitConcurrentUploads&&l.limitConcurrentUploads>r._sending)for(var n,a=r._slots.shift();a;){if(n=a.state?"pending"===a.state():!a.isRejected()){a.resolve();break}a=r._slots.shift()}})};return this._beforeSend(e,l),this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending?(this.options.limitConcurrentUploads>1?(o=t.Deferred(),this._slots.push(o),s=o.pipe(h)):s=this._sequence=this._sequence.pipe(h,h),s.abort=function(){return a=[void 0,"abort","abort"],n?n.abort():(o&&o.rejectWith(l.context,a),h())},this._enhancePromise(s)):h()},_onAdd:function(e,i){var n,a,o,s,r=this,l=!0,h=t.extend({},this.options,i),u=h.limitMultiFileUploads,c=this._getParamName(h);if((h.singleFileUploads||u)&&this._isXHRUpload(h))if(!h.singleFileUploads&&u)for(o=[],n=[],s=0;s<i.files.length;s+=u)o.push(i.files.slice(s,s+u)),a=c.slice(s,s+u),a.length||(a=c),n.push(a);else n=c;else o=[i.files],n=[c];return i.originalFiles=i.files,t.each(o||i.files,function(a,s){var h=t.extend({},i);return h.files=o?s:[s],h.paramName=n[a],h.submit=function(){return h.jqXHR=this.jqXHR=r._trigger("submit",e,this)!==!1&&r._onSend(e,this),this.jqXHR},l=r._trigger("add",e,h)}),l},_replaceFileInput:function(e){var i=e.clone(!0);t("<form></form>").append(i)[0].reset(),e.after(i).detach(),t.cleanData(e.unbind("remove")),this.options.fileInput=this.options.fileInput.map(function(t,n){return n===e[0]?i[0]:n}),e[0]===this.element[0]&&(this.element=i)},_handleFileTreeEntry:function(e,i){var n,a=this,o=t.Deferred(),s=function(t){t&&!t.entry&&(t.entry=e),o.resolve([t])};return i=i||"",e.isFile?e._file?(e._file.relativePath=i,o.resolve(e._file)):e.file(function(t){t.relativePath=i,o.resolve(t)},s):e.isDirectory?(n=e.createReader(),n.readEntries(function(t){a._handleFileTreeEntries(t,i+e.name+"/").done(function(t){o.resolve(t)}).fail(s)},s)):o.resolve([]),o.promise()},_handleFileTreeEntries:function(e,i){var n=this;return t.when.apply(t,t.map(e,function(t){return n._handleFileTreeEntry(t,i)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(e){e=e||{};var i=e.items;return i&&i.length&&(i[0].webkitGetAsEntry||i[0].getAsEntry)?this._handleFileTreeEntries(t.map(i,function(t){var e;return t.webkitGetAsEntry?(e=t.webkitGetAsEntry(),e&&(e._file=t.getAsFile()),e):t.getAsEntry()})):t.Deferred().resolve(t.makeArray(e.files)).promise()},_getSingleFileInputFiles:function(e){e=t(e);var i,n,a=e.prop("webkitEntries")||e.prop("entries");if(a&&a.length)return this._handleFileTreeEntries(a);if(i=t.makeArray(e.prop("files")),i.length)void 0===i[0].name&&i[0].fileName&&t.each(i,function(t,e){e.name=e.fileName,e.size=e.fileSize});else{if(n=e.prop("value"),!n)return t.Deferred().resolve([]).promise();i=[{name:n.replace(/^.*\\/,"")}]}return t.Deferred().resolve(i).promise()},_getFileInputFiles:function(e){return e instanceof t&&1!==e.length?t.when.apply(t,t.map(e,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)}):this._getSingleFileInputFiles(e)},_onChange:function(e){var i=this,n={fileInput:t(e.target),form:t(e.target.form)};this._getFileInputFiles(n.fileInput).always(function(t){n.files=t,i.options.replaceFileInput&&i._replaceFileInput(n.fileInput),i._trigger("change",e,n)!==!1&&i._onAdd(e,n)})},_onPaste:function(e){var i=e.originalEvent.clipboardData,n=i&&i.items||[],a={files:[]};return t.each(n,function(t,e){var i=e.getAsFile&&e.getAsFile();i&&a.files.push(i)}),this._trigger("paste",e,a)===!1||this._onAdd(e,a)===!1?!1:void 0},_onDrop:function(t){var e=this,i=t.dataTransfer=t.originalEvent.dataTransfer,n={};i&&i.files&&i.files.length&&t.preventDefault(),this._getDroppedFiles(i).always(function(i){n.files=i,e._trigger("drop",t,n)!==!1&&e._onAdd(t,n)})},_onDragOver:function(e){var i=e.dataTransfer=e.originalEvent.dataTransfer;return this._trigger("dragover",e)===!1?!1:void(i&&-1!==t.inArray("Files",i.types)&&(i.dropEffect="copy",e.preventDefault()))},_initEventHandlers:function(){this._isXHRUpload(this.options)&&(this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop}),this._on(this.options.pasteZone,{paste:this._onPaste})),this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragover drop"),this._off(this.options.pasteZone,"paste"),this._off(this.options.fileInput,"change")},_setOption:function(e,i){var n=-1!==t.inArray(e,this._refreshOptionsList);n&&this._destroyEventHandlers(),this._super(e,i),n&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var e=this.options;void 0===e.fileInput?e.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):e.fileInput instanceof t||(e.fileInput=t(e.fileInput)),e.dropZone instanceof t||(e.dropZone=t(e.dropZone)),e.pasteZone instanceof t||(e.pasteZone=t(e.pasteZone))},_create:function(){var e=this.options;t.extend(e,t(this.element[0].cloneNode(!1)).data()),this._initSpecialOptions(),this._slots=[],this._sequence=this._getXHRPromise(!0),this._sending=this._active=this._loaded=this._total=0,this._initEventHandlers()},_destroy:function(){this._destroyEventHandlers()},add:function(e){var i=this;e&&!this.options.disabled&&(e.fileInput&&!e.files?this._getFileInputFiles(e.fileInput).always(function(t){e.files=t,i._onAdd(null,e)}):(e.files=t.makeArray(e.files),this._onAdd(null,e)))},send:function(e){if(e&&!this.options.disabled){if(e.fileInput&&!e.files){var i,n,a=this,o=t.Deferred(),s=o.promise();return s.abort=function(){return n=!0,i?i.abort():(o.reject(null,"abort","abort"),s)},this._getFileInputFiles(e.fileInput).always(function(t){n||(e.files=t,i=a._onSend(null,e).then(function(t,e,i){o.resolve(t,e,i)},function(t,e,i){o.reject(t,e,i)}))}),this._enhancePromise(s)}if(e.files=t.makeArray(e.files),e.files.length)return this._onSend(null,e)}return this._getXHRPromise(!1,e&&e.context)}})}),function(t){"use strict";var e=function(t,i){var n=/[^\w\-\.:]/.test(t)?new Function(e.arg+",tmpl","var _e=tmpl.encode"+e.helper+",_s='"+t.replace(e.regexp,e.func)+"';return _s;"):e.cache[t]=e.cache[t]||e(e.load(t));return i?n(i,e):function(t){return n(t,e)}};e.cache={},e.load=function(t){return document.getElementById(t).innerHTML},e.regexp=/([\s'\\])(?![^%]*%\})|(?:\{%(=|#)([\s\S]+?)%\})|(\{%)|(%\})/g,e.func=function(t,e,i,n,a,o){return e?{"\n":"\\n","\r":"\\r","	":"\\t"," ":" "}[t]||"\\"+t:i?"="===i?"'+_e("+n+")+'":"'+("+n+"||'')+'":a?"';":o?"_s+='":void 0},e.encReg=/[<>&"'\x00]/g,e.encMap={"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&#39;"},e.encode=function(t){return String(t||"").replace(e.encReg,function(t){return e.encMap[t]||""})},e.arg="o",e.helper=",print=function(s,e){_s+=e&&(s||'')||_e(s);},include=function(s,d){_s+=tmpl(s,d);}","function"==typeof define&&define.amd?define(function(){return e}):t.tmpl=e}(this),function(){var t;t=jQuery,t.fn.S3Uploader=function(e){var i,n,a,o,s,r,l,h;return this.length>1?(this.each(function(){return t(this).S3Uploader(e)}),this):(i=this,h={path:"",additional_data:null,before_add:null,remove_completed_progress_bar:!0,remove_failed_progress_bar:!1,progress_bar_target:null,click_submit_target:null,allow_multiple_files:!0},t.extend(h,e),o=[],s=[],h.click_submit_target&&h.click_submit_target.click(function(){var t,e,i;for(e=0,i=s.length;i>e;e++)t=s[e],t.submit();return!1}),l=function(){return i.fileupload({add:function(e,n){var a;return a=n.files[0],a.unique_id=Math.random().toString(36).substr(2,16),!h.before_add||h.before_add(a)?(o.push(n),t("#template-upload").length>0?(n.context=t(t.trim(tmpl("template-upload",a))),t(n.context).appendTo(h.progress_bar_target||i)):h.allow_multiple_files||(n.context=h.progress_bar_target),h.click_submit_target?h.allow_multiple_files?s.push(n):s=[n]:n.submit()):void 0},start:function(t){return i.trigger("s3_uploads_start",[t])},progress:function(t,e){var i;return e.context?(i=parseInt(e.loaded/e.total*100,10),e.context.find(".bar").css("width",i+"%")):void 0},done:function(e,a){var s,r;return r=n(i,a.files[0],a.result),s=i.data("callback-url"),s&&(r[i.data("callback-param")]=r.url,t.ajax({type:i.data("callback-method"),url:s,data:r,beforeSend:function(t,e){return i.trigger("ajax:beforeSend",[t,e])},complete:function(t,e){return i.trigger("ajax:complete",[t,e])},success:function(t,e,n){return i.trigger("ajax:success",[t,e,n])},error:function(t,e,n){return i.trigger("ajax:error",[t,e,n])}})),a.context&&h.remove_completed_progress_bar&&a.context.remove(),i.trigger("s3_upload_complete",[r]),o.splice(t.inArray(a,o),1),o.length?void 0:i.trigger("s3_uploads_complete",[r])},fail:function(t,e){var a;return a=n(i,e.files[0],e.result),a.error_thrown=e.errorThrown,e.context&&h.remove_failed_progress_bar&&e.context.remove(),i.trigger("s3_upload_failed",[a])},formData:function(e){var n,a,o,s;return n=e.serializeArray(),a="","type"in this.files[0]&&(a=this.files[0].type),n.push({name:"content-type",value:a}),o=i.data("key").replace("{timestamp}",(new Date).getTime()).replace("{unique_id}",this.files[0].unique_id).replace("{extension}",this.files[0].name.split(".").pop()),s=t.grep(n,function(t){return"key"===t.name?t:void 0}),s.length>0&&(s[0].value=h.path+o),"FormData"in window||i.find("input[name='key']").val(h.path+o),n}})},n=function(e,i,n){var o,s;return o={},n?(o.url=t(n).find("Location").text(),o.filepath=t("<a />").attr("href",o.url)[0].pathname):(s=e.attr("action"),o.filepath=e.find("input[name=key]").val().replace("/${filename}",""),o.url=s+o.filepath+"/"+encodeURIComponent(i.name)),o.filename=i.name,"size"in i&&(o.filesize=i.size),"lastModifiedDate"in i&&(o.lastModifiedDate=i.lastModifiedDate),"type"in i&&(o.filetype=i.type),"unique_id"in i&&(o.unique_id=i.unique_id),r(i)&&(o.relativePath=a(i)),h.additional_data&&(o=t.extend(o,h.additional_data)),o},r=function(t){return t.relativePath||t.webkitRelativePath},a=function(t){return t.relativePath||(t.webkitRelativePath?t.webkitRelativePath.split("/").slice(0,-1).join("/")+"/":void 0)},this.initialize=function(){return i.data("key",i.find("input[name='key']").val()),l(),this},this.path=function(t){return h.path=t},this.additional_data=function(t){return h.additional_data=t},this.initialize())}}.call(this),function(){"use strict";var t=this,e=t.Chart,i=function(t){this.canvas=t.canvas,this.ctx=t;this.width=t.canvas.width,this.height=t.canvas.height;return this.aspectRatio=this.width/this.height,n.retinaScale(this),this};i.defaults={global:{animation:!0,animationSteps:60,animationEasing:"easeOutQuart",showScale:!0,scaleOverride:!1,scaleSteps:null,scaleStepWidth:null,scaleStartValue:null,scaleLineColor:"rgba(0,0,0,.1)",scaleLineWidth:1,scaleShowLabels:!0,scaleLabel:"<%=value%>",scaleIntegersOnly:!0,scaleBeginAtZero:!1,scaleFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",scaleFontSize:12,scaleFontStyle:"normal",scaleFontColor:"#666",responsive:!1,maintainAspectRatio:!0,showTooltips:!0,tooltipEvents:["mousemove","touchstart","touchmove","mouseout"],tooltipFillColor:"rgba(0,0,0,0.8)",tooltipFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",tooltipFontSize:14,tooltipFontStyle:"normal",tooltipFontColor:"#fff",tooltipTitleFontFamily:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",tooltipTitleFontSize:14,tooltipTitleFontStyle:"bold",tooltipTitleFontColor:"#fff",tooltipYPadding:6,tooltipXPadding:6,tooltipCaretSize:8,tooltipCornerRadius:6,tooltipXOffset:10,tooltipTemplate:"<%if (label){%><%=label%>: <%}%><%= value %>",multiTooltipTemplate:"<%= value %>",multiTooltipKeyBackground:"#fff",onAnimationProgress:function(){},onAnimationComplete:function(){}}},i.types={};var n=i.helpers={},a=n.each=function(t,e,i){var n=Array.prototype.slice.call(arguments,3);if(t)if(t.length===+t.length){var a;for(a=0;a<t.length;a++)e.apply(i,[t[a],a].concat(n))}else for(var o in t)e.apply(i,[t[o],o].concat(n))},o=n.clone=function(t){var e={};return a(t,function(i,n){t.hasOwnProperty(n)&&(e[n]=i)}),e},s=n.extend=function(t){return a(Array.prototype.slice.call(arguments,1),function(e){a(e,function(i,n){e.hasOwnProperty(n)&&(t[n]=i)})}),t},r=n.merge=function(){var t=Array.prototype.slice.call(arguments,0);return t.unshift({}),s.apply(null,t)},l=n.indexOf=function(t,e){if(Array.prototype.indexOf)return t.indexOf(e);for(var i=0;i<t.length;i++)if(t[i]===e)return i;return-1},h=(n.where=function(t,e){var i=[];return n.each(t,function(t){e(t)&&i.push(t)}),i},n.findNextWhere=function(t,e,i){i||(i=-1);for(var n=i+1;n<t.length;n++){var a=t[n];if(e(a))return a}},n.findPreviousWhere=function(t,e,i){i||(i=t.length);for(var n=i-1;n>=0;n--){var a=t[n];if(e(a))return a}},n.inherits=function(t){var e=this,i=t&&t.hasOwnProperty("constructor")?t.constructor:function(){return e.apply(this,arguments)},n=function(){this.constructor=i};return n.prototype=e.prototype,i.prototype=new n,i.extend=h,t&&s(i.prototype,t),i.__super__=e.prototype,i}),u=n.noop=function(){},c=n.uid=function(){var t=0;return function(){return"chart-"+t++}}(),d=n.warn=function(t){window.console&&"function"==typeof window.console.warn&&console.warn(t)},p=n.amd="function"==typeof define&&define.amd,f=n.isNumber=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},g=n.max=function(t){return Math.max.apply(Math,t)},m=n.min=function(t){return Math.min.apply(Math,t)},v=(n.cap=function(t,e,i){if(f(e)){if(t>e)return e}else if(f(i)&&i>t)return i;return t},n.getDecimalPlaces=function(t){return t%1!==0&&f(t)?t.toString().split(".")[1].length:0}),y=n.radians=function(t){return t*(Math.PI/180)},x=(n.getAngleFromPoint=function(t,e){var i=e.x-t.x,n=e.y-t.y,a=Math.sqrt(i*i+n*n),o=2*Math.PI+Math.atan2(n,i);return 0>i&&0>n&&(o+=2*Math.PI),{angle:o,distance:a}},n.aliasPixel=function(t){return t%2===0?0:.5}),w=(n.splineCurve=function(t,e,i,n){var a=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2)),o=Math.sqrt(Math.pow(i.x-e.x,2)+Math.pow(i.y-e.y,2)),s=n*a/(a+o),r=n*o/(a+o);return{inner:{x:e.x-s*(i.x-t.x),y:e.y-s*(i.y-t.y)},outer:{x:e.x+r*(i.x-t.x),y:e.y+r*(i.y-t.y)}}},n.calculateOrderOfMagnitude=function(t){return Math.floor(Math.log(t)/Math.LN10)}),b=(n.calculateScaleRange=function(t,e,i,n,a){var o=2,s=Math.floor(e/(1.5*i)),r=o>=s,l=g(t),h=m(t);l===h&&(l+=.5,h>=.5&&!n?h-=.5:l+=.5);for(var u=Math.abs(l-h),c=w(u),d=Math.ceil(l/(1*Math.pow(10,c)))*Math.pow(10,c),p=n?0:Math.floor(h/(1*Math.pow(10,c)))*Math.pow(10,c),f=d-p,v=Math.pow(10,c),y=Math.round(f/v);(y>s||s>2*y)&&!r;)if(y>s)v*=2,y=Math.round(f/v),y%1!==0&&(r=!0);else if(a&&c>=0){if(v/2%1!==0)break;v/=2,y=Math.round(f/v)}else v/=2,y=Math.round(f/v);return r&&(y=o,v=f/y),{steps:y,stepValue:v,min:p,max:p+y*v}},n.template=function(t,e){function i(t,e){var i=/\W/.test(t)?new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+t.replace(/[\r\t\n]/g," ").split("<%").join("	").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("	").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');"):n[t]=n[t];return e?i(e):i}if(t instanceof Function)return t(e);var n={};return i(t,e)}),_=(n.generateLabels=function(t,e,i,n){var o=new Array(e);return labelTemplateString&&a(o,function(e,a){o[a]=b(t,{value:i+n*(a+1)})}),o},n.easingEffects={linear:function(t){return t},easeInQuad:function(t){return t*t},easeOutQuad:function(t){return-1*t*(t-2)},easeInOutQuad:function(t){return(t/=.5)<1?.5*t*t:-0.5*(--t*(t-2)-1)},easeInCubic:function(t){return t*t*t},easeOutCubic:function(t){return 1*((t=t/1-1)*t*t+1)},easeInOutCubic:function(t){return(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},easeInQuart:function(t){return t*t*t*t},easeOutQuart:function(t){return-1*((t=t/1-1)*t*t*t-1)},easeInOutQuart:function(t){return(t/=.5)<1?.5*t*t*t*t:-0.5*((t-=2)*t*t*t-2)},easeInQuint:function(t){return 1*(t/=1)*t*t*t*t},easeOutQuint:function(t){return 1*((t=t/1-1)*t*t*t*t+1)},easeInOutQuint:function(t){return(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},easeInSine:function(t){return-1*Math.cos(t/1*(Math.PI/2))+1},easeOutSine:function(t){return 1*Math.sin(t/1*(Math.PI/2))},easeInOutSine:function(t){return-0.5*(Math.cos(Math.PI*t/1)-1)},easeInExpo:function(t){return 0===t?1:1*Math.pow(2,10*(t/1-1))},easeOutExpo:function(t){return 1===t?1:1*(-Math.pow(2,-10*t/1)+1)},easeInOutExpo:function(t){return 0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(-Math.pow(2,-10*--t)+2)},easeInCirc:function(t){return t>=1?t:-1*(Math.sqrt(1-(t/=1)*t)-1)},easeOutCirc:function(t){return 1*Math.sqrt(1-(t=t/1-1)*t)},easeInOutCirc:function(t){return(t/=.5)<1?-0.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},easeInElastic:function(t){var e=1.70158,i=0,n=1;return 0===t?0:1==(t/=1)?1:(i||(i=.3),n<Math.abs(1)?(n=1,e=i/4):e=i/(2*Math.PI)*Math.asin(1/n),-(n*Math.pow(2,10*(t-=1))*Math.sin(2*(1*t-e)*Math.PI/i)))
},easeOutElastic:function(t){var e=1.70158,i=0,n=1;return 0===t?0:1==(t/=1)?1:(i||(i=.3),n<Math.abs(1)?(n=1,e=i/4):e=i/(2*Math.PI)*Math.asin(1/n),n*Math.pow(2,-10*t)*Math.sin(2*(1*t-e)*Math.PI/i)+1)},easeInOutElastic:function(t){var e=1.70158,i=0,n=1;return 0===t?0:2==(t/=.5)?1:(i||(i=.3*1.5),n<Math.abs(1)?(n=1,e=i/4):e=i/(2*Math.PI)*Math.asin(1/n),1>t?-.5*n*Math.pow(2,10*(t-=1))*Math.sin(2*(1*t-e)*Math.PI/i):n*Math.pow(2,-10*(t-=1))*Math.sin(2*(1*t-e)*Math.PI/i)*.5+1)},easeInBack:function(t){var e=1.70158;return 1*(t/=1)*t*((e+1)*t-e)},easeOutBack:function(t){var e=1.70158;return 1*((t=t/1-1)*t*((e+1)*t+e)+1)},easeInOutBack:function(t){var e=1.70158;return(t/=.5)<1?.5*t*t*(((e*=1.525)+1)*t-e):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:function(t){return 1-_.easeOutBounce(1-t)},easeOutBounce:function(t){return(t/=1)<1/2.75?7.5625*t*t:2/2.75>t?1*(7.5625*(t-=1.5/2.75)*t+.75):2.5/2.75>t?1*(7.5625*(t-=2.25/2.75)*t+.9375):1*(7.5625*(t-=2.625/2.75)*t+.984375)},easeInOutBounce:function(t){return.5>t?.5*_.easeInBounce(2*t):.5*_.easeOutBounce(2*t-1)+.5}}),S=n.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){return window.setTimeout(t,1e3/60)}}(),C=(n.cancelAnimFrame=function(){return window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||function(t){return window.clearTimeout(t,1e3/60)}}(),n.animationLoop=function(t,e,i,n,a,o){var s=0,r=_[i]||_.linear,l=function(){s++;var i=s/e,h=r(i);t.call(o,h,i,s),n.call(o,h,i),e>s?o.animationFrame=S(l):a.apply(o)};S(l)},n.getRelativePosition=function(t){var e,i,n=t.originalEvent||t,a=t.currentTarget||t.srcElement,o=a.getBoundingClientRect();return n.touches?(e=n.touches[0].clientX-o.left,i=n.touches[0].clientY-o.top):(e=n.clientX-o.left,i=n.clientY-o.top),{x:e,y:i}},n.addEvent=function(t,e,i){t.addEventListener?t.addEventListener(e,i):t.attachEvent?t.attachEvent("on"+e,i):t["on"+e]=i}),P=n.removeEvent=function(t,e,i){t.removeEventListener?t.removeEventListener(e,i,!1):t.detachEvent?t.detachEvent("on"+e,i):t["on"+e]=u},T=(n.bindEvents=function(t,e,i){t.events||(t.events={}),a(e,function(e){t.events[e]=function(){i.apply(t,arguments)},C(t.chart.canvas,e,t.events[e])})},n.unbindEvents=function(t,e){a(e,function(e,i){P(t.chart.canvas,i,e)})}),k=n.getMaximumWidth=function(t){var e=t.parentNode;return e.clientWidth},F=n.getMaximumHeight=function(t){var e=t.parentNode;return e.clientHeight},I=(n.getMaximumSize=n.getMaximumWidth,n.retinaScale=function(t){var e=t.ctx,i=t.canvas.width,n=t.canvas.height;window.devicePixelRatio&&(e.canvas.style.width=i+"px",e.canvas.style.height=n+"px",e.canvas.height=n*window.devicePixelRatio,e.canvas.width=i*window.devicePixelRatio,e.scale(window.devicePixelRatio,window.devicePixelRatio))}),A=n.clear=function(t){t.ctx.clearRect(0,0,t.width,t.height)},R=n.fontString=function(t,e,i){return e+" "+t+"px "+i},L=n.longestText=function(t,e,i){t.font=e;var n=0;return a(i,function(e){var i=t.measureText(e).width;n=i>n?i:n}),n},E=n.drawRoundedRectangle=function(t,e,i,n,a,o){t.beginPath(),t.moveTo(e+o,i),t.lineTo(e+n-o,i),t.quadraticCurveTo(e+n,i,e+n,i+o),t.lineTo(e+n,i+a-o),t.quadraticCurveTo(e+n,i+a,e+n-o,i+a),t.lineTo(e+o,i+a),t.quadraticCurveTo(e,i+a,e,i+a-o),t.lineTo(e,i+o),t.quadraticCurveTo(e,i,e+o,i),t.closePath()};i.instances={},i.Type=function(t,e,n){this.options=e,this.chart=n,this.id=c(),i.instances[this.id]=this,e.responsive&&this.resize(),this.initialize.call(this,t)},s(i.Type.prototype,{initialize:function(){return this},clear:function(){return A(this.chart),this},stop:function(){return n.cancelAnimFrame.call(t,this.animationFrame),this},resize:function(t){this.stop();var e=this.chart.canvas,i=k(this.chart.canvas),n=this.options.maintainAspectRatio?i/this.chart.aspectRatio:F(this.chart.canvas);return e.width=this.chart.width=i,e.height=this.chart.height=n,I(this.chart),"function"==typeof t&&t.apply(this,Array.prototype.slice.call(arguments,1)),this},reflow:u,render:function(t){return t&&this.reflow(),this.options.animation&&!t?n.animationLoop(this.draw,this.options.animationSteps,this.options.animationEasing,this.options.onAnimationProgress,this.options.onAnimationComplete,this):(this.draw(),this.options.onAnimationComplete.call(this)),this},generateLegend:function(){return b(this.options.legendTemplate,this)},destroy:function(){this.clear(),T(this,this.events),delete i.instances[this.id]},showTooltip:function(t,e){"undefined"==typeof this.activeElements&&(this.activeElements=[]);var o=function(t){var e=!1;return t.length!==this.activeElements.length?e=!0:(a(t,function(t,i){t!==this.activeElements[i]&&(e=!0)},this),e)}.call(this,t);if(o||e){if(this.activeElements=t,this.draw(),t.length>0)if(this.datasets&&this.datasets.length>1){for(var s,r,h=this.datasets.length-1;h>=0&&(s=this.datasets[h].points||this.datasets[h].bars||this.datasets[h].segments,r=l(s,t[0]),-1===r);h--);var u=[],c=[],d=function(){var t,e,i,a,o,s=[],l=[],h=[];return n.each(this.datasets,function(e){t=e.points||e.bars||e.segments,t[r]&&t[r].hasValue()&&s.push(t[r])}),n.each(s,function(t){l.push(t.x),h.push(t.y),u.push(n.template(this.options.multiTooltipTemplate,t)),c.push({fill:t._saved.fillColor||t.fillColor,stroke:t._saved.strokeColor||t.strokeColor})},this),o=m(h),i=g(h),a=m(l),e=g(l),{x:a>this.chart.width/2?a:e,y:(o+i)/2}}.call(this,r);new i.MultiTooltip({x:d.x,y:d.y,xPadding:this.options.tooltipXPadding,yPadding:this.options.tooltipYPadding,xOffset:this.options.tooltipXOffset,fillColor:this.options.tooltipFillColor,textColor:this.options.tooltipFontColor,fontFamily:this.options.tooltipFontFamily,fontStyle:this.options.tooltipFontStyle,fontSize:this.options.tooltipFontSize,titleTextColor:this.options.tooltipTitleFontColor,titleFontFamily:this.options.tooltipTitleFontFamily,titleFontStyle:this.options.tooltipTitleFontStyle,titleFontSize:this.options.tooltipTitleFontSize,cornerRadius:this.options.tooltipCornerRadius,labels:u,legendColors:c,legendColorBackground:this.options.multiTooltipKeyBackground,title:t[0].label,chart:this.chart,ctx:this.chart.ctx}).draw()}else a(t,function(t){var e=t.tooltipPosition();new i.Tooltip({x:Math.round(e.x),y:Math.round(e.y),xPadding:this.options.tooltipXPadding,yPadding:this.options.tooltipYPadding,fillColor:this.options.tooltipFillColor,textColor:this.options.tooltipFontColor,fontFamily:this.options.tooltipFontFamily,fontStyle:this.options.tooltipFontStyle,fontSize:this.options.tooltipFontSize,caretHeight:this.options.tooltipCaretSize,cornerRadius:this.options.tooltipCornerRadius,text:b(this.options.tooltipTemplate,t),chart:this.chart}).draw()},this);return this}},toBase64Image:function(){return this.chart.canvas.toDataURL.apply(this.chart.canvas,arguments)}}),i.Type.extend=function(t){var e=this,n=function(){return e.apply(this,arguments)};if(n.prototype=o(e.prototype),s(n.prototype,t),n.extend=i.Type.extend,t.name||e.prototype.name){var a=t.name||e.prototype.name,l=i.defaults[e.prototype.name]?o(i.defaults[e.prototype.name]):{};i.defaults[a]=s(l,t.defaults),i.types[a]=n,i.prototype[a]=function(t,e){var o=r(i.defaults.global,i.defaults[a],e||{});return new n(t,o,this)}}else d("Name not provided for this chart, so it hasn't been registered");return e},i.Element=function(t){s(this,t),this.initialize.apply(this,arguments),this.save()},s(i.Element.prototype,{initialize:function(){},restore:function(t){return t?a(t,function(t){this[t]=this._saved[t]},this):s(this,this._saved),this},save:function(){return this._saved=o(this),delete this._saved._saved,this},update:function(t){return a(t,function(t,e){this._saved[e]=this[e],this[e]=t},this),this},transition:function(t,e){return a(t,function(t,i){this[i]=(t-this._saved[i])*e+this._saved[i]},this),this},tooltipPosition:function(){return{x:this.x,y:this.y}},hasValue:function(){return f(this.value)}}),i.Element.extend=h,i.Point=i.Element.extend({display:!0,inRange:function(t,e){var i=this.hitDetectionRadius+this.radius;return Math.pow(t-this.x,2)+Math.pow(e-this.y,2)<Math.pow(i,2)},draw:function(){if(this.display){var t=this.ctx;t.beginPath(),t.arc(this.x,this.y,this.radius,0,2*Math.PI),t.closePath(),t.strokeStyle=this.strokeColor,t.lineWidth=this.strokeWidth,t.fillStyle=this.fillColor,t.fill(),t.stroke()}}}),i.Arc=i.Element.extend({inRange:function(t,e){var i=n.getAngleFromPoint(this,{x:t,y:e}),a=i.angle>=this.startAngle&&i.angle<=this.endAngle,o=i.distance>=this.innerRadius&&i.distance<=this.outerRadius;return a&&o},tooltipPosition:function(){var t=this.startAngle+(this.endAngle-this.startAngle)/2,e=(this.outerRadius-this.innerRadius)/2+this.innerRadius;return{x:this.x+Math.cos(t)*e,y:this.y+Math.sin(t)*e}},draw:function(t){var e=this.ctx;e.beginPath(),e.arc(this.x,this.y,this.outerRadius,this.startAngle,this.endAngle),e.arc(this.x,this.y,this.innerRadius,this.endAngle,this.startAngle,!0),e.closePath(),e.strokeStyle=this.strokeColor,e.lineWidth=this.strokeWidth,e.fillStyle=this.fillColor,e.fill(),e.lineJoin="bevel",this.showStroke&&e.stroke()}}),i.Rectangle=i.Element.extend({draw:function(){var t=this.ctx,e=this.width/2,i=this.x-e,n=this.x+e,a=this.base-(this.base-this.y),o=this.strokeWidth/2;this.showStroke&&(i+=o,n-=o,a+=o),t.beginPath(),t.fillStyle=this.fillColor,t.strokeStyle=this.strokeColor,t.lineWidth=this.strokeWidth,t.moveTo(i,this.base),t.lineTo(i,a),t.lineTo(n,a),t.lineTo(n,this.base),t.fill(),this.showStroke&&t.stroke()},height:function(){return this.base-this.y},inRange:function(t,e){return t>=this.x-this.width/2&&t<=this.x+this.width/2&&e>=this.y&&e<=this.base}}),i.Tooltip=i.Element.extend({draw:function(){var t=this.chart.ctx;t.font=R(this.fontSize,this.fontStyle,this.fontFamily),this.xAlign="center",this.yAlign="above";var e=2,i=t.measureText(this.text).width+2*this.xPadding,n=this.fontSize+2*this.yPadding,a=n+this.caretHeight+e;this.x+i/2>this.chart.width?this.xAlign="left":this.x-i/2<0&&(this.xAlign="right"),this.y-a<0&&(this.yAlign="below");var o=this.x-i/2,s=this.y-a;switch(t.fillStyle=this.fillColor,this.yAlign){case"above":t.beginPath(),t.moveTo(this.x,this.y-e),t.lineTo(this.x+this.caretHeight,this.y-(e+this.caretHeight)),t.lineTo(this.x-this.caretHeight,this.y-(e+this.caretHeight)),t.closePath(),t.fill();break;case"below":s=this.y+e+this.caretHeight,t.beginPath(),t.moveTo(this.x,this.y+e),t.lineTo(this.x+this.caretHeight,this.y+e+this.caretHeight),t.lineTo(this.x-this.caretHeight,this.y+e+this.caretHeight),t.closePath(),t.fill()}switch(this.xAlign){case"left":o=this.x-i+(this.cornerRadius+this.caretHeight);break;case"right":o=this.x-(this.cornerRadius+this.caretHeight)}E(t,o,s,i,n,this.cornerRadius),t.fill(),t.fillStyle=this.textColor,t.textAlign="center",t.textBaseline="middle",t.fillText(this.text,o+i/2,s+n/2)}}),i.MultiTooltip=i.Element.extend({initialize:function(){this.font=R(this.fontSize,this.fontStyle,this.fontFamily),this.titleFont=R(this.titleFontSize,this.titleFontStyle,this.titleFontFamily),this.height=this.labels.length*this.fontSize+(this.labels.length-1)*(this.fontSize/2)+2*this.yPadding+1.5*this.titleFontSize,this.ctx.font=this.titleFont;var t=this.ctx.measureText(this.title).width,e=L(this.ctx,this.font,this.labels)+this.fontSize+3,i=g([e,t]);this.width=i+2*this.xPadding;var n=this.height/2;this.y-n<0?this.y=n:this.y+n>this.chart.height&&(this.y=this.chart.height-n),this.x>this.chart.width/2?this.x-=this.xOffset+this.width:this.x+=this.xOffset},getLineHeight:function(t){var e=this.y-this.height/2+this.yPadding,i=t-1;return 0===t?e+this.titleFontSize/2:e+(1.5*this.fontSize*i+this.fontSize/2)+1.5*this.titleFontSize},draw:function(){E(this.ctx,this.x,this.y-this.height/2,this.width,this.height,this.cornerRadius);var t=this.ctx;t.fillStyle=this.fillColor,t.fill(),t.closePath(),t.textAlign="left",t.textBaseline="middle",t.fillStyle=this.titleTextColor,t.font=this.titleFont,t.fillText(this.title,this.x+this.xPadding,this.getLineHeight(0)),t.font=this.font,n.each(this.labels,function(e,i){t.fillStyle=this.textColor,t.fillText(e,this.x+this.xPadding+this.fontSize+3,this.getLineHeight(i+1)),t.fillStyle=this.legendColorBackground,t.fillRect(this.x+this.xPadding,this.getLineHeight(i+1)-this.fontSize/2,this.fontSize,this.fontSize),t.fillStyle=this.legendColors[i].fill,t.fillRect(this.x+this.xPadding,this.getLineHeight(i+1)-this.fontSize/2,this.fontSize,this.fontSize)},this)}}),i.Scale=i.Element.extend({initialize:function(){this.fit()},buildYLabels:function(){this.yLabels=[];for(var t=v(this.stepValue),e=0;e<=this.steps;e++)this.yLabels.push(b(this.templateString,{value:(this.min+e*this.stepValue).toFixed(t)}));this.yLabelWidth=this.display&&this.showLabels?L(this.ctx,this.font,this.yLabels):0},addXLabel:function(t){this.xLabels.push(t),this.valuesCount++,this.fit()},removeXLabel:function(){this.xLabels.shift(),this.valuesCount--,this.fit()},fit:function(){this.startPoint=this.display?this.fontSize:0,this.endPoint=this.display?this.height-1.5*this.fontSize-5:this.height,this.startPoint+=this.padding,this.endPoint-=this.padding;var t,e=this.endPoint-this.startPoint;for(this.calculateYRange(e),this.buildYLabels(),this.calculateXLabelRotation();e>this.endPoint-this.startPoint;)e=this.endPoint-this.startPoint,t=this.yLabelWidth,this.calculateYRange(e),this.buildYLabels(),t<this.yLabelWidth&&this.calculateXLabelRotation()},calculateXLabelRotation:function(){this.ctx.font=this.font;var t,e,i=this.ctx.measureText(this.xLabels[0]).width,n=this.ctx.measureText(this.xLabels[this.xLabels.length-1]).width;if(this.xScalePaddingRight=n/2+3,this.xScalePaddingLeft=i/2>this.yLabelWidth+10?i/2:this.yLabelWidth+10,this.xLabelRotation=0,this.display){var a,o=L(this.ctx,this.font,this.xLabels);this.xLabelWidth=o;for(var s=Math.floor(this.calculateX(1)-this.calculateX(0))-6;this.xLabelWidth>s&&0===this.xLabelRotation||this.xLabelWidth>s&&this.xLabelRotation<=90&&this.xLabelRotation>0;)a=Math.cos(y(this.xLabelRotation)),t=a*i,e=a*n,t+this.fontSize/2>this.yLabelWidth+8&&(this.xScalePaddingLeft=t+this.fontSize/2),this.xScalePaddingRight=this.fontSize/2,this.xLabelRotation++,this.xLabelWidth=a*o;this.xLabelRotation>0&&(this.endPoint-=Math.sin(y(this.xLabelRotation))*o+3)}else this.xLabelWidth=0,this.xScalePaddingRight=this.padding,this.xScalePaddingLeft=this.padding},calculateYRange:u,drawingArea:function(){return this.startPoint-this.endPoint},calculateY:function(t){var e=this.drawingArea()/(this.min-this.max);return this.endPoint-e*(t-this.min)},calculateX:function(t){var e=(this.xLabelRotation>0,this.width-(this.xScalePaddingLeft+this.xScalePaddingRight)),i=e/(this.valuesCount-(this.offsetGridLines?0:1)),n=i*t+this.xScalePaddingLeft;return this.offsetGridLines&&(n+=i/2),Math.round(n)},update:function(t){n.extend(this,t),this.fit()},draw:function(){var t=this.ctx,e=(this.endPoint-this.startPoint)/this.steps,i=Math.round(this.xScalePaddingLeft);this.display&&(t.fillStyle=this.textColor,t.font=this.font,a(this.yLabels,function(a,o){var s=this.endPoint-e*o,r=Math.round(s);t.textAlign="right",t.textBaseline="middle",this.showLabels&&t.fillText(a,i-10,s),t.beginPath(),o>0?(t.lineWidth=this.gridLineWidth,t.strokeStyle=this.gridLineColor):(t.lineWidth=this.lineWidth,t.strokeStyle=this.lineColor),r+=n.aliasPixel(t.lineWidth),t.moveTo(i,r),t.lineTo(this.width,r),t.stroke(),t.closePath(),t.lineWidth=this.lineWidth,t.strokeStyle=this.lineColor,t.beginPath(),t.moveTo(i-5,r),t.lineTo(i,r),t.stroke(),t.closePath()},this),a(this.xLabels,function(e,i){var n=this.calculateX(i)+x(this.lineWidth),a=this.calculateX(i-(this.offsetGridLines?.5:0))+x(this.lineWidth),o=this.xLabelRotation>0;t.beginPath(),i>0?(t.lineWidth=this.gridLineWidth,t.strokeStyle=this.gridLineColor):(t.lineWidth=this.lineWidth,t.strokeStyle=this.lineColor),t.moveTo(a,this.endPoint),t.lineTo(a,this.startPoint-3),t.stroke(),t.closePath(),t.lineWidth=this.lineWidth,t.strokeStyle=this.lineColor,t.beginPath(),t.moveTo(a,this.endPoint),t.lineTo(a,this.endPoint+5),t.stroke(),t.closePath(),t.save(),t.translate(n,o?this.endPoint+12:this.endPoint+8),t.rotate(-1*y(this.xLabelRotation)),t.font=this.font,t.textAlign=o?"right":"center",t.textBaseline=o?"middle":"top",t.fillText(e,0,0),t.restore()},this))}}),i.RadialScale=i.Element.extend({initialize:function(){this.size=m([this.height,this.width]),this.drawingArea=this.display?this.size/2-(this.fontSize/2+this.backdropPaddingY):this.size/2},calculateCenterOffset:function(t){var e=this.drawingArea/(this.max-this.min);return(t-this.min)*e},update:function(){this.lineArc?this.drawingArea=this.display?this.size/2-(this.fontSize/2+this.backdropPaddingY):this.size/2:this.setScaleSize(),this.buildYLabels()},buildYLabels:function(){this.yLabels=[];for(var t=v(this.stepValue),e=0;e<=this.steps;e++)this.yLabels.push(b(this.templateString,{value:(this.min+e*this.stepValue).toFixed(t)}))},getCircumference:function(){return 2*Math.PI/this.valuesCount},setScaleSize:function(){var t,e,i,n,a,o,s,r,l,h,u,c,d=m([this.height/2-this.pointLabelFontSize-5,this.width/2]),p=this.width,g=0;for(this.ctx.font=R(this.pointLabelFontSize,this.pointLabelFontStyle,this.pointLabelFontFamily),e=0;e<this.valuesCount;e++)t=this.getPointPosition(e,d),i=this.ctx.measureText(b(this.templateString,{value:this.labels[e]})).width+5,0===e||e===this.valuesCount/2?(n=i/2,t.x+n>p&&(p=t.x+n,a=e),t.x-n<g&&(g=t.x-n,s=e)):e<this.valuesCount/2?t.x+i>p&&(p=t.x+i,a=e):e>this.valuesCount/2&&t.x-i<g&&(g=t.x-i,s=e);l=g,h=Math.ceil(p-this.width),o=this.getIndexAngle(a),r=this.getIndexAngle(s),u=h/Math.sin(o+Math.PI/2),c=l/Math.sin(r+Math.PI/2),u=f(u)?u:0,c=f(c)?c:0,this.drawingArea=d-(c+u)/2,this.setCenterPoint(c,u)},setCenterPoint:function(t,e){var i=this.width-e-this.drawingArea,n=t+this.drawingArea;this.xCenter=(n+i)/2,this.yCenter=this.height/2},getIndexAngle:function(t){var e=2*Math.PI/this.valuesCount;return t*e-Math.PI/2},getPointPosition:function(t,e){var i=this.getIndexAngle(t);return{x:Math.cos(i)*e+this.xCenter,y:Math.sin(i)*e+this.yCenter}},draw:function(){if(this.display){var t=this.ctx;if(a(this.yLabels,function(e,i){if(i>0){var n,a=i*(this.drawingArea/this.steps),o=this.yCenter-a;if(this.lineWidth>0)if(t.strokeStyle=this.lineColor,t.lineWidth=this.lineWidth,this.lineArc)t.beginPath(),t.arc(this.xCenter,this.yCenter,a,0,2*Math.PI),t.closePath(),t.stroke();else{t.beginPath();for(var s=0;s<this.valuesCount;s++)n=this.getPointPosition(s,this.calculateCenterOffset(this.min+i*this.stepValue)),0===s?t.moveTo(n.x,n.y):t.lineTo(n.x,n.y);t.closePath(),t.stroke()}if(this.showLabels){if(t.font=R(this.fontSize,this.fontStyle,this.fontFamily),this.showLabelBackdrop){var r=t.measureText(e).width;t.fillStyle=this.backdropColor,t.fillRect(this.xCenter-r/2-this.backdropPaddingX,o-this.fontSize/2-this.backdropPaddingY,r+2*this.backdropPaddingX,this.fontSize+2*this.backdropPaddingY)}t.textAlign="center",t.textBaseline="middle",t.fillStyle=this.fontColor,t.fillText(e,this.xCenter,o)}}},this),!this.lineArc){t.lineWidth=this.angleLineWidth,t.strokeStyle=this.angleLineColor;for(var e=this.valuesCount-1;e>=0;e--){if(this.angleLineWidth>0){var i=this.getPointPosition(e,this.calculateCenterOffset(this.max));t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(i.x,i.y),t.stroke(),t.closePath()}var n=this.getPointPosition(e,this.calculateCenterOffset(this.max)+5);t.font=R(this.pointLabelFontSize,this.pointLabelFontStyle,this.pointLabelFontFamily),t.fillStyle=this.pointLabelFontColor;var o=this.labels.length,s=this.labels.length/2,r=s/2,l=r>e||e>o-r,h=e===r||e===o-r;t.textAlign=0===e?"center":e===s?"center":s>e?"left":"right",t.textBaseline=h?"middle":l?"bottom":"top",t.fillText(this.labels[e],n.x,n.y)}}}}}),n.addEvent(window,"resize",function(){var t;return function(){clearTimeout(t),t=setTimeout(function(){a(i.instances,function(t){t.options.responsive&&t.resize(t.render,!0)})},50)}}()),p?define(function(){return i}):"object"==typeof module&&module.exports&&(module.exports=i),t.Chart=i,i.noConflict=function(){return t.Chart=e,i}}.call(this),function(){"use strict";var t=this,e=t.Chart,i=e.helpers,n={scaleShowGridLines:!0,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,bezierCurve:!0,bezierCurveTension:.4,pointDot:!0,pointDotRadius:4,pointDotStrokeWidth:1,pointHitDetectionRadius:20,datasetStroke:!0,datasetStrokeWidth:2,datasetFill:!0,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].strokeColor%>"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>'};e.Type.extend({name:"Line",defaults:n,initialize:function(t){this.PointClass=e.Point.extend({strokeWidth:this.options.pointDotStrokeWidth,radius:this.options.pointDotRadius,display:this.options.pointDot,hitDetectionRadius:this.options.pointHitDetectionRadius,ctx:this.chart.ctx,inRange:function(t){return Math.pow(t-this.x,2)<Math.pow(this.radius+this.hitDetectionRadius,2)}}),this.datasets=[],this.options.showTooltips&&i.bindEvents(this,this.options.tooltipEvents,function(t){var e="mouseout"!==t.type?this.getPointsAtEvent(t):[];this.eachPoints(function(t){t.restore(["fillColor","strokeColor"])}),i.each(e,function(t){t.fillColor=t.highlightFill,t.strokeColor=t.highlightStroke}),this.showTooltip(e)}),i.each(t.datasets,function(e){var n={label:e.label||null,fillColor:e.fillColor,strokeColor:e.strokeColor,pointColor:e.pointColor,pointStrokeColor:e.pointStrokeColor,points:[]};this.datasets.push(n),i.each(e.data,function(i,a){n.points.push(new this.PointClass({value:i,label:t.labels[a],datasetLabel:e.label,strokeColor:e.pointStrokeColor,fillColor:e.pointColor,highlightFill:e.pointHighlightFill||e.pointColor,highlightStroke:e.pointHighlightStroke||e.pointStrokeColor}))},this),this.buildScale(t.labels),this.eachPoints(function(t,e){i.extend(t,{x:this.scale.calculateX(e),y:this.scale.endPoint}),t.save()},this)},this),this.render()},update:function(){this.scale.update(),i.each(this.activeElements,function(t){t.restore(["fillColor","strokeColor"])}),this.eachPoints(function(t){t.save()}),this.render()},eachPoints:function(t){i.each(this.datasets,function(e){i.each(e.points,t,this)},this)},getPointsAtEvent:function(t){var e=[],n=i.getRelativePosition(t);return i.each(this.datasets,function(t){i.each(t.points,function(t){t.inRange(n.x,n.y)&&e.push(t)})},this),e},buildScale:function(t){var n=this,a=function(){var t=[];return n.eachPoints(function(e){t.push(e.value)}),t},o={templateString:this.options.scaleLabel,height:this.chart.height,width:this.chart.width,ctx:this.chart.ctx,textColor:this.options.scaleFontColor,fontSize:this.options.scaleFontSize,fontStyle:this.options.scaleFontStyle,fontFamily:this.options.scaleFontFamily,valuesCount:t.length,beginAtZero:this.options.scaleBeginAtZero,integersOnly:this.options.scaleIntegersOnly,calculateYRange:function(t){var e=i.calculateScaleRange(a(),t,this.fontSize,this.beginAtZero,this.integersOnly);i.extend(this,e)},xLabels:t,font:i.fontString(this.options.scaleFontSize,this.options.scaleFontStyle,this.options.scaleFontFamily),lineWidth:this.options.scaleLineWidth,lineColor:this.options.scaleLineColor,gridLineWidth:this.options.scaleShowGridLines?this.options.scaleGridLineWidth:0,gridLineColor:this.options.scaleShowGridLines?this.options.scaleGridLineColor:"rgba(0,0,0,0)",padding:this.options.showScale?0:this.options.pointDotRadius+this.options.pointDotStrokeWidth,showLabels:this.options.scaleShowLabels,display:this.options.showScale};this.options.scaleOverride&&i.extend(o,{calculateYRange:i.noop,steps:this.options.scaleSteps,stepValue:this.options.scaleStepWidth,min:this.options.scaleStartValue,max:this.options.scaleStartValue+this.options.scaleSteps*this.options.scaleStepWidth}),this.scale=new e.Scale(o)},addData:function(t,e){i.each(t,function(t,i){this.datasets[i].points.push(new this.PointClass({value:t,label:e,x:this.scale.calculateX(this.scale.valuesCount+1),y:this.scale.endPoint,strokeColor:this.datasets[i].pointStrokeColor,fillColor:this.datasets[i].pointColor}))},this),this.scale.addXLabel(e),this.update()},removeData:function(){this.scale.removeXLabel(),i.each(this.datasets,function(t){t.points.shift()},this),this.update()},reflow:function(){var t=i.extend({height:this.chart.height,width:this.chart.width});this.scale.update(t)},draw:function(t){var e=t||1;this.clear();var n=this.chart.ctx,a=function(t){return null!==t.value},o=function(t,e,n){return i.findNextWhere(e,a,n)||t},s=function(t,e,n){return i.findPreviousWhere(e,a,n)||t};this.scale.draw(e),i.each(this.datasets,function(t){var r=i.where(t.points,a);i.each(t.points,function(t,i){t.hasValue()&&t.transition({y:this.scale.calculateY(t.value),x:this.scale.calculateX(i)},e)},this),this.options.bezierCurve&&i.each(r,function(t,e){var n=e>0&&e<r.length-1?this.options.bezierCurveTension:0;t.controlPoints=i.splineCurve(s(t,r,e),t,o(t,r,e),n),t.controlPoints.outer.y>this.scale.endPoint?t.controlPoints.outer.y=this.scale.endPoint:t.controlPoints.outer.y<this.scale.startPoint&&(t.controlPoints.outer.y=this.scale.startPoint),t.controlPoints.inner.y>this.scale.endPoint?t.controlPoints.inner.y=this.scale.endPoint:t.controlPoints.inner.y<this.scale.startPoint&&(t.controlPoints.inner.y=this.scale.startPoint)},this),n.lineWidth=this.options.datasetStrokeWidth,n.strokeStyle=t.strokeColor,n.beginPath(),i.each(r,function(t,e){if(0===e)n.moveTo(t.x,t.y);else if(this.options.bezierCurve){var i=s(t,r,e);n.bezierCurveTo(i.controlPoints.outer.x,i.controlPoints.outer.y,t.controlPoints.inner.x,t.controlPoints.inner.y,t.x,t.y)}else n.lineTo(t.x,t.y)},this),n.stroke(),this.options.datasetFill&&r.length>0&&(n.lineTo(r[r.length-1].x,this.scale.endPoint),n.lineTo(r[0].x,this.scale.endPoint),n.fillStyle=t.fillColor,n.closePath(),n.fill()),i.each(r,function(t){t.draw()})},this)}})}.call(this),function(){"use strict";var t=this,e=t.Chart,i=e.helpers,n={segmentShowStroke:!0,segmentStrokeColor:"#fff",segmentStrokeWidth:2,percentageInnerCutout:50,animationSteps:100,animationEasing:"easeOutBounce",animateRotate:!0,animateScale:!1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<segments.length; i++){%><li><span style="background-color:<%=segments[i].fillColor%>"></span><%if(segments[i].label){%><%=segments[i].label%><%}%></li><%}%></ul>'};e.Type.extend({name:"Doughnut",defaults:n,initialize:function(t){this.segments=[],this.outerRadius=(i.min([this.chart.width,this.chart.height])-this.options.segmentStrokeWidth/2)/2,this.SegmentArc=e.Arc.extend({ctx:this.chart.ctx,x:this.chart.width/2,y:this.chart.height/2}),this.options.showTooltips&&i.bindEvents(this,this.options.tooltipEvents,function(t){var e="mouseout"!==t.type?this.getSegmentsAtEvent(t):[];i.each(this.segments,function(t){t.restore(["fillColor"])}),i.each(e,function(t){t.fillColor=t.highlightColor}),this.showTooltip(e)}),this.calculateTotal(t),i.each(t,function(t,e){this.addData(t,e,!0)},this),this.render()},getSegmentsAtEvent:function(t){var e=[],n=i.getRelativePosition(t);return i.each(this.segments,function(t){t.inRange(n.x,n.y)&&e.push(t)},this),e},addData:function(t,e,i){var n=e||this.segments.length;this.segments.splice(n,0,new this.SegmentArc({value:t.value,outerRadius:this.options.animateScale?0:this.outerRadius,innerRadius:this.options.animateScale?0:this.outerRadius/100*this.options.percentageInnerCutout,fillColor:t.color,highlightColor:t.highlight||t.color,showStroke:this.options.segmentShowStroke,strokeWidth:this.options.segmentStrokeWidth,strokeColor:this.options.segmentStrokeColor,startAngle:1.5*Math.PI,circumference:this.options.animateRotate?0:this.calculateCircumference(t.value),label:t.label})),i||(this.reflow(),this.update())},calculateCircumference:function(t){return 2*Math.PI*(t/this.total)},calculateTotal:function(t){this.total=0,i.each(t,function(t){this.total+=t.value},this)},update:function(){this.calculateTotal(this.segments),i.each(this.activeElements,function(t){t.restore(["fillColor"])}),i.each(this.segments,function(t){t.save()}),this.render()},removeData:function(t){var e=i.isNumber(t)?t:this.segments.length-1;this.segments.splice(e,1),this.reflow(),this.update()},reflow:function(){i.extend(this.SegmentArc.prototype,{x:this.chart.width/2,y:this.chart.height/2}),this.outerRadius=(i.min([this.chart.width,this.chart.height])-this.options.segmentStrokeWidth/2)/2,i.each(this.segments,function(t){t.update({outerRadius:this.outerRadius,innerRadius:this.outerRadius/100*this.options.percentageInnerCutout})},this)},draw:function(t){var e=t?t:1;this.clear(),i.each(this.segments,function(t,i){t.transition({circumference:this.calculateCircumference(t.value),outerRadius:this.outerRadius,innerRadius:this.outerRadius/100*this.options.percentageInnerCutout},e),t.endAngle=t.startAngle+t.circumference,t.draw(),0===i&&(t.startAngle=1.5*Math.PI),i<this.segments.length-1&&(this.segments[i+1].startAngle=t.endAngle)},this)}}),e.types.Doughnut.extend({name:"Pie",defaults:i.merge(n,{percentageInnerCutout:0})})}.call(this),function(t){t.fn.animateNumbers=function(e,i,n,a){return this.each(function(){var o=t(this),s=parseInt(o.text().replace(/,/g,""));i=void 0===i?!0:i,t({value:s}).animate({value:e},{duration:void 0==n?1e3:n,easing:void 0==a?"swing":a,step:function(){o.text(Math.floor(this.value)),i&&o.text(o.text().replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,"))},complete:function(){parseInt(o.text())!==e&&(o.text(e),i&&o.text(o.text().replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")))}})})}}(jQuery),function(t){var e=new Array,n=new Array;t.fn.doAutosize=function(e){var i=t(this).data("minwidth"),n=t(this).data("maxwidth"),a="",o=t(this),s=t("#"+t(this).data("tester_id"));if(a!==(a=o.val())){var r=a.replace(/&/g,"&amp;").replace(/\s/g," ").replace(/</g,"&lt;").replace(/>/g,"&gt;");s.html(r);var l=s.width(),h=l+e.comfortZone>=i?l+e.comfortZone:i,u=o.width(),c=u>h&&h>=i||h>i&&n>h;c&&o.width(h)}},t.fn.resetAutosize=function(e){var i=t(this).data("minwidth")||e.minInputWidth||t(this).width(),n=t(this).data("maxwidth")||e.maxInputWidth||t(this).closest(".tagsinput").width()-e.inputPadding,a=t(this),o=t("<tester/>").css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:a.css("fontSize"),fontFamily:a.css("fontFamily"),fontWeight:a.css("fontWeight"),letterSpacing:a.css("letterSpacing"),whiteSpace:"nowrap"}),s=t(this).attr("id")+"_autosize_tester";!t("#"+s).length>0&&(o.attr("id",s),o.appendTo("body")),a.data("minwidth",i),a.data("maxwidth",n),a.data("tester_id",s),a.css("width",i)},t.fn.addTag=function(i,a){return a=jQuery.extend({focus:!1,callback:!0},a),this.each(function(){var o=t(this).attr("id"),s=t(this).val().split(e[o]);if(""==s[0]&&(s=new Array),i=jQuery.trim(i),a.unique){var r=t(this).tagExist(i);1==r&&t("#"+o+"_tag").addClass("not_valid")}else var r=!1;if(""!=i&&1!=r){if(t("<span>").addClass("tag").append(t("<span>").text(i).append("&nbsp;&nbsp;"),t("<a>",{href:"#",title:"Removing tag",text:"x"}).click(function(){return t("#"+o).removeTag(escape(i))})).insertBefore("#"+o+"_addTag"),s.push(i),t("#"+o+"_tag").val(""),a.focus?t("#"+o+"_tag").focus():t("#"+o+"_tag").blur(),t.fn.tagsInput.updateTagsField(this,s),a.callback&&n[o]&&n[o].onAddTag){var l=n[o].onAddTag;l.call(this,i)}if(n[o]&&n[o].onChange){var h=s.length,l=n[o].onChange;l.call(this,t(this),s[h-1])}}}),!1},t.fn.removeTag=function(a){return a=unescape(a),this.each(function(){var o=t(this).attr("id"),s=t(this).val().split(e[o]);for(t("#"+o+"_tagsinput .tag").remove(),str="",i=0;i<s.length;i++)s[i]!=a&&(str=str+e[o]+s[i]);if(t.fn.tagsInput.importTags(this,str),n[o]&&n[o].onRemoveTag){var r=n[o].onRemoveTag;r.call(this,a)}}),!1},t.fn.tagExist=function(i){var n=t(this).attr("id"),a=t(this).val().split(e[n]);return jQuery.inArray(i,a)>=0},t.fn.importTags=function(e){id=t(this).attr("id"),t("#"+id+"_tagsinput .tag").remove(),t.fn.tagsInput.importTags(this,e)},t.fn.tagsInput=function(i){var a=jQuery.extend({interactive:!0,defaultText:"add a tag",minChars:0,width:"300px",height:"100px",autocomplete:{selectFirst:!1},hide:!0,delimiter:",",unique:!0,removeWithBackspace:!0,placeholderColor:"#666666",autosize:!0,comfortZone:20,inputPadding:12},i);return this.each(function(){a.hide&&t(this).hide();var i=t(this).attr("id");(!i||e[t(this).attr("id")])&&(i=t(this).attr("id","tags"+(new Date).getTime()).attr("id"));var o=jQuery.extend({pid:i,real_input:"#"+i,holder:"#"+i+"_tagsinput",input_wrapper:"#"+i+"_addTag",fake_input:"#"+i+"_tag"},a);e[i]=o.delimiter,(a.onAddTag||a.onRemoveTag||a.onChange)&&(n[i]=new Array,n[i].onAddTag=a.onAddTag,n[i].onRemoveTag=a.onRemoveTag,n[i].onChange=a.onChange);var s='<div id="'+i+'_tagsinput" class="tagsinput"><div id="'+i+'_addTag">';if(a.interactive&&(s=s+'<input id="'+i+'_tag" value="" data-default="'+a.defaultText+'" />'),s+='</div><div class="tags_clear"></div></div>',t(s).insertAfter(this),t(o.holder).css("width",a.width),t(o.holder).css("min-height",a.height),t(o.holder).css("height","100%"),""!=t(o.real_input).val()&&t.fn.tagsInput.importTags(t(o.real_input),t(o.real_input).val()),a.interactive){if(t(o.fake_input).val(t(o.fake_input).attr("data-default")),t(o.fake_input).css("color",a.placeholderColor),t(o.fake_input).resetAutosize(a),t(o.holder).bind("click",o,function(e){t(e.data.fake_input).focus()
}),t(o.fake_input).bind("focus",o,function(e){t(e.data.fake_input).val()==t(e.data.fake_input).attr("data-default")&&t(e.data.fake_input).val(""),t(e.data.fake_input).css("color","#000000")}),void 0!=a.autocomplete_url){autocomplete_options={source:a.autocomplete_url};for(attrname in a.autocomplete)autocomplete_options[attrname]=a.autocomplete[attrname];void 0!==jQuery.Autocompleter?(t(o.fake_input).autocomplete(a.autocomplete_url,a.autocomplete),t(o.fake_input).bind("result",o,function(e,n){n&&t("#"+i).addTag(n[0]+"",{focus:!0,unique:a.unique})})):void 0!==jQuery.ui.autocomplete&&(t(o.fake_input).autocomplete(autocomplete_options),t(o.fake_input).bind("autocompleteselect",o,function(e,i){return t(e.data.real_input).addTag(i.item.value,{focus:!0,unique:a.unique}),!1}))}else t(o.fake_input).bind("blur",o,function(e){var i=t(this).attr("data-default");return""!=t(e.data.fake_input).val()&&t(e.data.fake_input).val()!=i?e.data.minChars<=t(e.data.fake_input).val().length&&(!e.data.maxChars||e.data.maxChars>=t(e.data.fake_input).val().length)&&t(e.data.real_input).addTag(t(e.data.fake_input).val(),{focus:!0,unique:a.unique}):(t(e.data.fake_input).val(t(e.data.fake_input).attr("data-default")),t(e.data.fake_input).css("color",a.placeholderColor)),!1});t(o.fake_input).bind("keypress",o,function(e){return e.which==e.data.delimiter.charCodeAt(0)||13==e.which?(e.preventDefault(),e.data.minChars<=t(e.data.fake_input).val().length&&(!e.data.maxChars||e.data.maxChars>=t(e.data.fake_input).val().length)&&t(e.data.real_input).addTag(t(e.data.fake_input).val(),{focus:!0,unique:a.unique}),t(e.data.fake_input).resetAutosize(a),!1):void(e.data.autosize&&t(e.data.fake_input).doAutosize(a))}),o.removeWithBackspace&&t(o.fake_input).bind("keydown",function(e){if(8==e.keyCode&&""==t(this).val()){e.preventDefault();var i=t(this).closest(".tagsinput").find(".tag:last").text(),n=t(this).attr("id").replace(/_tag$/,"");i=i.replace(/[\s]+x$/,""),t("#"+n).removeTag(escape(i)),t(this).trigger("focus")}}),t(o.fake_input).blur(),o.unique&&t(o.fake_input).keydown(function(e){(8==e.keyCode||String.fromCharCode(e.which).match(/\w+|[\xe1\xe9\xed\xf3\xfa\xc1\xc9\xcd\xd3\xda\xf1\xd1,/]+/))&&t(this).removeClass("not_valid")})}}),this},t.fn.tagsInput.updateTagsField=function(i,n){var a=t(i).attr("id");t(i).val(n.join(e[a]))},t.fn.tagsInput.importTags=function(a,o){t(a).val("");var s=t(a).attr("id"),r=o.split(e[s]);for(i=0;i<r.length;i++)t(a).addTag(r[i],{focus:!1,callback:!1});if(n[s]&&n[s].onChange){var l=n[s].onChange;l.call(a,a,r[i])}}}(jQuery),function(t,e){var i,n,a,o,s,r;i=n={},a={},o={},s={},r={tagDataSelector:"[data-taggable]",pluginOptions:{width:"100%",height:"100%",placeholderColor:"#999999"}},i.init=function(){this.$window=e(t),this.$tagInputs=e(r.tagDataSelector)},o.init=function(){this.initializeTagInputs()},o.initializeTagInputs=function(){n.$tagInputs.tagsInput(r.pluginOptions)},s.init=function(){this.catchReinitializeTagInputsEvent(),this.catchExtendTagInputsEvent()},s.catchReinitializeTagInputsEvent=function(){n.$window.on("tagInputs:reinitialize",function(){i.init(),o.init()})},s.catchExtendTagInputsEvent=function(){n.$window.on("tagInputs:extend",function(){i.init(),o.init()})},s.emitReinitializeTagInputsEvent=function(){n.$window.trigger("tagInputs:reinitialize")},s.emitExtendTagInputsEvent=function(){n.$window.trigger("tagInputs:extend")},e(function(){i.init(),o.init(),s.init()}),t.UI=e.extend(t.UI,{emitReinitializeTagInputsEvent:s.emitReinitializeTagInputsEvent,emitExtendTagInputsEvent:s.emitExtendTagInputsEvent})}(window,jQuery),function(t){var e=function(t){return this.data=t,this.absolutes=_.pluck(this.data,"absolute").reverse(),this.deltas=_.pluck(this.data,"delta").reverse(),this.growths=_.pluck(this.data,"growth").reverse(),this};t.RecordableObject=e}(window,jQuery),function(t,e){var i,n,a,o,s,r;i=n={},a={},o={},s={},r={uploadingText:"Uploading..."},i.init=function(){this.$uploader=e(".js-s3-uploader"),this.$formHolder=e(".js-form-holder"),this.$pseudoSelectFile=e(".js-upload-trigger"),this.$selectFile=e(".js-upload-trigger-handler"),this.$submit=e(".js-upload-submit"),this.submitText=this.$submit.val()},a.init=function(t){this[t]={},this[t].progress=0,this[t].$container=e(".js-form-holder").find("[data-unique-id="+t+"]"),this[t].$progress=this[t].$container.find(".js-progress-bar"),this[t].$url=this[t].$container.find(".js-url"),this[t].$filetype=this[t].$container.find(".js-filetype"),this[t].$filepath=this[t].$container.find(".js-filepath"),this[t].$filesize=this[t].$container.find(".js-filesize")},o.init=function(){this.template=JST["templates/upload"],n.$uploader.length&&(s.init(),o.bindUploaderActions(),o.bindUploaderEvents())},o.bindUploaderActions=function(){n.$pseudoSelectFile.on("click",o.triggerUploadClick)},o.triggerUploadClick=function(){n.$selectFile.trigger("click")},o.bindUploaderEvents=function(){n.$uploader.on("fileuploadsend",s.onStart),n.$uploader.on("fileuploadprogress",s.onProgress),n.$uploader.on("s3_upload_complete",s.onComplete),n.$uploader.on("s3_uploads_complete",s.onAllComplete)},o.renderAndAppend=function(t){var i=this.template(t);e(".js-form-holder").append(i)},o.disableSubmitButton=function(){n.$submit.attr("disabled",!0).removeClass("hide"),n.$submit.val(r.uploadingText)},o.enableSubmitButton=function(){n.$submit.attr("disabled",!1),n.$submit.val(n.submitText)},o.hideAddPhotosButton=function(){n.$pseudoSelectFile.addClass("hide")},o.updateProgressBar=function(t){a[t]&&a[t].$progress.css("width",100*a[t].progress+"%")},o.updateFormValues=function(t){var e=t.unique_id;a[e].$url.val(t.url),a[e].$filetype.val(t.filetype),a[e].$filepath.val(t.filepath),a[e].$filesize.val(t.filesize)},o.showProgressBar=function(t){a[t].$container.addClass("upload--is-uploading")},o.hideProgressBar=function(t){a[t].$container.removeClass("upload--is-uploading")},s.init=function(){n.$uploader.S3Uploader({dropzone:e("body"),before_add:s.isValidFile})},s.isValidFile=function(t){return/(\.|\/)(tiff|jpe?g|png)$/i.test(t.type)?t.size>5e7?(alert("Uploads must be less than 50 megabytes in size."),!1):!0:(alert("Uploads must be one of the following file types: tiff, jpeg, png"),!1)},s.onStart=function(t,e){o.hideAddPhotosButton(),o.disableSubmitButton(),_.each(e.files,function(t){var e=t.unique_id,i=new FileReader;i.onload=function(t){var i=t.target.result;o.renderAndAppend({src:i,uniqueId:e}),a.init(e),o.showProgressBar(e)},i.readAsDataURL(t)})},s.onProgress=function(t,e){var i=e.files[0],n=i.unique_id,s=e.loaded/e.total;a[n].progress=s,o.updateProgressBar(n)},s.onComplete=function(t,e){o.updateFormValues(e),o.hideProgressBar(e.unique_id)},s.onAllComplete=function(){o.enableSubmitButton()},e(function(){i.init(),o.init()})}(window,jQuery),function(t,e){var i,n,a,o,s,r;i=n={},a={},o={},s={},r={rotateInterval:6e3},i.init=function(){this.$window=e(t),this.$loadingSpinner=e(".js-loading-spinner"),this.$background=e(".js-stats-background"),this.$totalDownloadsContainer=e(".js-total-downloads-container"),this.$totalDownloads=e(".js-stat-total-downloads"),this.$statsContainer=e(".js-stats-container"),this.$photoDownloads=e(".js-stat-photo-downloads"),this.$photoRank=e(".js-stat-photo-rank"),this.$photoPublishedDate=e(".js-stat-photo-published-date"),this.$preloadedImages=e(".js-preloaded-images")},o.init=function(){this.currentIndex=null,this.currentPhoto=null},o.setData=function(t){this.data=t},o.getNextPhotoIndex=function(){return this.currentIndex==o.data.photos.length-1?0:this.currentIndex+1},o.updateData=function(){e.getJSON("/stats",function(t){o.data=t,a.updateTotalDownloads()})},o.pollForNewData=function(){o.updateData(),setTimeout(o.pollForNewData,12e3)},a.shouldInitialize=function(){return n.$totalDownloads.length&&n.$photoDownloads.length},a.init=function(){},a.showSpinner=function(){n.$loadingSpinner.show()},a.hideSpinner=function(){n.$loadingSpinner.hide()},a.rotateToIndex=function(t){o.currentPhoto=o.data.photos[t],o.currentIndex=t,a.showSpinner(),a.fadeInPhoto(),a.updateTotalDownloads(),n.$photoDownloads.text(o.currentPhoto.downloads.toLocaleString()),n.$photoRank.text(o.currentPhoto.rank||"--"),n.$photoPublishedDate.text(o.currentPhoto.published_at),a.hideSpinner();var e=o.getNextPhotoIndex();setTimeout(function(){a.rotateToIndex(e)},r.rotateInterval)},a.fadeInPhoto=function(){n.$background.each(function(){e(this).removeClass("active")}),e(n.$background[o.currentIndex]).addClass("active")},a.animateInStats=function(){n.$statsContainer.addClass("active"),n.$totalDownloadsContainer.addClass("active")},a.updateTotalDownloads=function(){n.$totalDownloads.animateNumbers(o.data.totalDownloads,!0,2e3)},s.init=function(){this.catchNewDataEvent(),this.catchStartEvent()},s.catchNewDataEvent=function(){n.$window.on("stats:data",function(t,e){o.setData(e.content)})},s.emitNewDataEvent=function(t){n.$window.trigger("stats:data",{content:t})},s.emitStartEvent=function(){n.$window.trigger("stats:start")},s.catchStartEvent=function(){n.$window.on("stats:start",function(){var t=n.$preloadedImages.find("img")[0];e(t).imagesLoaded(function(){a.rotateToIndex(0),a.animateInStats(),o.pollForNewData()})})},e(function(){i.init(),a.shouldInitialize()&&(o.init(),a.init(),s.init())}),t.Stats={emitNewDataEvent:s.emitNewDataEvent,emitStartEvent:s.emitStartEvent}}(window,jQuery);